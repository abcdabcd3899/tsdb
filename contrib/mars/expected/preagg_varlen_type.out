\set tname_auto test_mars_preagg_varlen_type_auto
\set tname_v1 test_mars_preagg_varlen_type_v1
-- default, for now it means v2
\set tname :tname_auto
\i sql/preagg_varlen_type.template
\set tnamestr '''' :tname ''''
select gp_debug_set_create_table_default_numsegments(1);
 gp_debug_set_create_table_default_numsegments 
-----------------------------------------------
 1
(1 row)

-- verify text and varchar(n)
--start_ignore
drop table if exists :tname;
create table :tname (c0 int, c1 text, c2 varchar(100), c3 int8, ts timestamp) using mars
 with (group_col_ = '{c0}', group_param_col_ = '{ts in 1 hour}') distributed by (c0);
--end_ignore
insert into :tname
     select i/5,
            ((i+3)%7)::text,
            ((i+5)%7)::varchar(100),
            i,
            '2020-10-10 09:01:02'::timestamp + i * interval '1 second'
       from generate_series(0, 12) i;
select ctid, c0, c1, c2, c3 from :tname;
 ctid  | c0 | c1 | c2 | c3 
-------+----+----+----+----
 (1,1) |  0 | 3  | 5  |  0
 (1,2) |  0 | 4  | 6  |  1
 (1,3) |  0 | 5  | 0  |  2
 (1,4) |  0 | 6  | 1  |  3
 (1,5) |  0 | 0  | 2  |  4
 (2,1) |  1 | 1  | 3  |  5
 (2,2) |  1 | 2  | 4  |  6
 (2,3) |  1 | 3  | 5  |  7
 (2,4) |  1 | 4  | 6  |  8
 (2,5) |  1 | 5  | 0  |  9
 (3,1) |  2 | 6  | 1  | 10
 (3,2) |  2 | 0  | 2  | 11
 (3,3) |  2 | 1  | 3  | 12
(13 rows)

\out /dev/null
select segrelid as aux_table_oid
     , segrelid::regclass::name as aux_table_name
  from mx_mars
 where relid = :tnamestr::regclass;
\out
\gset
\set aux_table_name_str '''' :aux_table_name ''''
select sum, min_at, max_at, min, max from gp_dist_random(:aux_table_name_str);
                                                                                sum                                                                                 |                                       min_at                                       |                                       max_at                                       |                                              min                                               |                                              max                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------
 \x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000 | \x00000000000000000400000000000000020000000000000000000000000000000000000000000000 | \x04000000000000000300000000000000010000000000000004000000000000000400000000000000 | \x000000000000000028000000000000002c000000000000000000000000000000804fbc124c540200823000008230 | \x000000000000000028000000000000002c0000000000000004000000000000008058f9124c540200823600008236
 \x0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002300000000000000000000000000000000000000000000000000000000000000 | \x00000000000000000000000000000000040000000000000000000000000000000000000000000000 | \x04000000000000000400000000000000030000000000000004000000000000000400000000000000 | \x010000000000000028000000000000002c000000000000000500000000000000c09a08134c540200823100008230 | \x010000000000000028000000000000002c000000000000000900000000000000c0a345134c540200823500008236
 \x0600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002100000000000000000000000000000000000000000000000000000000000000 | \x00000000000000000100000000000000000000000000000000000000000000000000000000000000 | \x02000000000000000000000000000000020000000000000002000000000000000200000000000000 | \x020000000000000028000000000000002c000000000000000a0000000000000000e654134c540200823000008231 | \x020000000000000028000000000000002c000000000000000c00000000000000806a73134c540200823600008233
(3 rows)

select min(c1), max(c1) from :tname;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c1), max(c1) from :tname where c0 = 0;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c1), max(c1) from :tname where c0 = 1;
 min | max 
-----+-----
 1   | 5
(1 row)

select min(c1), max(c1) from :tname where c0 = 2;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname where c0 = 0;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname where c0 = 1;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname where c0 = 2;
 min | max 
-----+-----
 1   | 3
(1 row)

-- verify numeric and interval
--start_ignore
drop table if exists :tname;
create table :tname (c0 int, c1 numeric, c2 interval, c3 int8, ts timestamp) using mars
 with (group_col_ = '{c0}', group_param_col_ = '{ts in 1 hour}') distributed by (c0);
--end_ignore
insert into :tname
     select i/5,
            (i+3)%7,
            make_interval(mins => ((i+5)%7)),
            i,
            '2020-10-10 09:01:02'::timestamp + i * interval '1 second'
       from generate_series(0, 12) i;
select ctid, c0, c1, c2, c3 from :tname;
 ctid  | c0 | c1 |    c2    | c3 
-------+----+----+----------+----
 (1,1) |  0 |  3 | @ 5 mins |  0
 (1,2) |  0 |  4 | @ 6 mins |  1
 (1,3) |  0 |  5 | @ 0      |  2
 (1,4) |  0 |  6 | @ 1 min  |  3
 (1,5) |  0 |  0 | @ 2 mins |  4
 (2,1) |  1 |  1 | @ 3 mins |  5
 (2,2) |  1 |  2 | @ 4 mins |  6
 (2,3) |  1 |  3 | @ 5 mins |  7
 (2,4) |  1 |  4 | @ 6 mins |  8
 (2,5) |  1 |  5 | @ 0      |  9
 (3,1) |  2 |  6 | @ 1 min  | 10
 (3,2) |  2 |  0 | @ 2 mins | 11
 (3,3) |  2 |  1 | @ 3 mins | 12
(13 rows)

\out /dev/null
select segrelid as aux_table_oid
     , segrelid::regclass::name as aux_table_name
  from mx_mars
 where relid = :tnamestr::regclass;
\out
\gset
\set aux_table_name_str '''' :aux_table_name ''''
select sum, min_at, max_at, min, max from gp_dist_random(:aux_table_name_str);
                                                                                sum                                                                                 |                                       min_at                                       |                                       max_at                                       |                                                                    min                                                                     |                                                                    max                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------
 \x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000 | \x00000000000000000400000000000000020000000000000000000000000000000000000000000000 | \x04000000000000000300000000000000010000000000000004000000000000000400000000000000 | \x000000000000000028000000000000002c000000000000000000000000000000804fbc124c5402008300800000000000000000000000000000000000                 | \x00000000000000002800000000000000340000000000000004000000000000008058f9124c540200850080060000000000000000002a7515000000000000000000000000
 \x0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002300000000000000000000000000000000000000000000000000000000000000 | \x00000000000000000000000000000000040000000000000000000000000000000000000000000000 | \x04000000000000000400000000000000030000000000000004000000000000000400000000000000 | \x0100000000000000280000000000000034000000000000000500000000000000c09a08134c54020085008001000000000000000000000000000000000000000000000000 | \x0100000000000000280000000000000034000000000000000900000000000000c0a345134c540200850080050000000000000000002a7515000000000000000000000000
 \x0600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002100000000000000000000000000000000000000000000000000000000000000 | \x00000000000000000100000000000000000000000000000000000000000000000000000000000000 | \x02000000000000000000000000000000020000000000000002000000000000000200000000000000 | \x020000000000000028000000000000002c000000000000000a0000000000000000e654134c5402008300800000879303000000000000000000000000                 | \x0200000000000000280000000000000034000000000000000c00000000000000806a73134c5402008500800600000000000000000095ba0a000000000000000000000000
(3 rows)

select min(c1), max(c1) from :tname;
 min | max 
-----+-----
   0 |   6
(1 row)

select min(c2), max(c2) from :tname;
 min |   max    
-----+----------
 @ 0 | @ 6 mins
(1 row)

select min(c1), max(c1) from :tname where c0 = 0;
 min | max 
-----+-----
   0 |   6
(1 row)

select min(c1), max(c1) from :tname where c0 = 1;
 min | max 
-----+-----
   1 |   5
(1 row)

select min(c1), max(c1) from :tname where c0 = 2;
 min | max 
-----+-----
   0 |   6
(1 row)

select min(c2), max(c2) from :tname where c0 = 0;
 min |   max    
-----+----------
 @ 0 | @ 6 mins
(1 row)

select min(c2), max(c2) from :tname where c0 = 1;
 min |   max    
-----+----------
 @ 0 | @ 6 mins
(1 row)

select min(c2), max(c2) from :tname where c0 = 2;
   min   |   max    
---------+----------
 @ 1 min | @ 3 mins
(1 row)

-- verify name and varchar
--start_ignore
drop table if exists :tname;
create table :tname (c0 int, c1 name, c2 varchar, c3 int8, ts timestamp) using mars
 with (group_col_ = '{c0}', group_param_col_ = '{ts in 1 hour}') distributed by (c0);
--end_ignore
insert into :tname
     select i/5,
            ((i+3)%7)::name,
            ((i+5)%7)::varchar,
            i,
            '2020-10-10 09:01:02'::timestamp + i * interval '1 second'
       from generate_series(0, 12) i;
select ctid, c0, c1, c2, c3 from :tname;
 ctid  | c0 | c1 | c2 | c3 
-------+----+----+----+----
 (1,1) |  0 | 3  | 5  |  0
 (1,2) |  0 | 4  | 6  |  1
 (1,3) |  0 | 5  | 0  |  2
 (1,4) |  0 | 6  | 1  |  3
 (1,5) |  0 | 0  | 2  |  4
 (2,1) |  1 | 1  | 3  |  5
 (2,2) |  1 | 2  | 4  |  6
 (2,3) |  1 | 3  | 5  |  7
 (2,4) |  1 | 4  | 6  |  8
 (2,5) |  1 | 5  | 0  |  9
 (3,1) |  2 | 6  | 1  | 10
 (3,2) |  2 | 0  | 2  | 11
 (3,3) |  2 | 1  | 3  | 12
(13 rows)

\out /dev/null
select segrelid as aux_table_oid
     , segrelid::regclass::name as aux_table_name
  from mx_mars
 where relid = :tnamestr::regclass;
\out
\gset
\set aux_table_name_str '''' :aux_table_name ''''
select sum, min_at, max_at, min, max from gp_dist_random(:aux_table_name_str);
                                                                                sum                                                                                 |                                       min_at                                       |                                       max_at                                       |                                                                                                          min                                                                                                           |                                                                                                          max                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 \x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000 | \x00000000000000000400000000000000020000000000000000000000000000000000000000000000 | \x04000000000000000300000000000000010000000000000004000000000000000400000000000000 | \x0000000000000000280000000000000068000000000000000000000000000000804fbc124c540200300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008230 | \x00000000000000002800000000000000680000000000000004000000000000008058f9124c540200360000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008236
 \x0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002300000000000000000000000000000000000000000000000000000000000000 | \x00000000000000000000000000000000040000000000000000000000000000000000000000000000 | \x04000000000000000400000000000000030000000000000004000000000000000400000000000000 | \x0100000000000000280000000000000068000000000000000500000000000000c09a08134c540200310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008230 | \x0100000000000000280000000000000068000000000000000900000000000000c0a345134c540200350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008236
 \x0600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002100000000000000000000000000000000000000000000000000000000000000 | \x00000000000000000100000000000000000000000000000000000000000000000000000000000000 | \x02000000000000000000000000000000020000000000000002000000000000000200000000000000 | \x0200000000000000280000000000000068000000000000000a0000000000000000e654134c540200300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008231 | \x0200000000000000280000000000000068000000000000000c00000000000000806a73134c540200360000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008233
(3 rows)

select min(c1), max(c1) from :tname;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c1), max(c1) from :tname where c0 = 0;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c1), max(c1) from :tname where c0 = 1;
 min | max 
-----+-----
 1   | 5
(1 row)

select min(c1), max(c1) from :tname where c0 = 2;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname where c0 = 0;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname where c0 = 1;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname where c0 = 2;
 min | max 
-----+-----
 1   | 3
(1 row)

-- v1
set mars.default_auxfile_format to 'v1';
show mars.default_auxfile_format;
 mars.default_auxfile_format 
-----------------------------
 v1
(1 row)

\set tname :tname_v1
\i sql/preagg_varlen_type.template
\set tnamestr '''' :tname ''''
select gp_debug_set_create_table_default_numsegments(1);
 gp_debug_set_create_table_default_numsegments 
-----------------------------------------------
 1
(1 row)

-- verify text and varchar(n)
--start_ignore
drop table if exists :tname;
create table :tname (c0 int, c1 text, c2 varchar(100), c3 int8, ts timestamp) using mars
 with (group_col_ = '{c0}', group_param_col_ = '{ts in 1 hour}') distributed by (c0);
--end_ignore
insert into :tname
     select i/5,
            ((i+3)%7)::text,
            ((i+5)%7)::varchar(100),
            i,
            '2020-10-10 09:01:02'::timestamp + i * interval '1 second'
       from generate_series(0, 12) i;
select ctid, c0, c1, c2, c3 from :tname;
 ctid  | c0 | c1 | c2 | c3 
-------+----+----+----+----
 (1,1) |  0 | 3  | 5  |  0
 (1,2) |  0 | 4  | 6  |  1
 (1,3) |  0 | 5  | 0  |  2
 (1,4) |  0 | 6  | 1  |  3
 (1,5) |  0 | 0  | 2  |  4
 (2,1) |  1 | 1  | 3  |  5
 (2,2) |  1 | 2  | 4  |  6
 (2,3) |  1 | 3  | 5  |  7
 (2,4) |  1 | 4  | 6  |  8
 (2,5) |  1 | 5  | 0  |  9
 (3,1) |  2 | 6  | 1  | 10
 (3,2) |  2 | 0  | 2  | 11
 (3,3) |  2 | 1  | 3  | 12
(13 rows)

\out /dev/null
select segrelid as aux_table_oid
     , segrelid::regclass::name as aux_table_name
  from mx_mars
 where relid = :tnamestr::regclass;
\out
\gset
\set aux_table_name_str '''' :aux_table_name ''''
select sum, min_at, max_at, min, max from gp_dist_random(:aux_table_name_str);
                                                                                   sum                                                                                   |                     min_at                      |                     max_at                      |                                                 min                                                 |                                                 max                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------------+-----------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------
 {"\\x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000"} | {"\\x0000000004000000020000000000000000000000"} | {"\\x0400000003000000010000000400000004000000"} | {"\\x000000000000000028000000000000002c000000000000000000000000000000804fbc124c540200823000008230"} | {"\\x000000000000000028000000000000002c0000000000000004000000000000008058f9124c540200823600008236"}
 {"\\x0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002300000000000000000000000000000000000000000000000000000000000000"} | {"\\x0000000000000000040000000000000000000000"} | {"\\x0400000004000000030000000400000004000000"} | {"\\x010000000000000028000000000000002c000000000000000500000000000000c09a08134c540200823100008230"} | {"\\x010000000000000028000000000000002c000000000000000900000000000000c0a345134c540200823500008236"}
 {"\\x0600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002100000000000000000000000000000000000000000000000000000000000000"} | {"\\x0000000001000000000000000000000000000000"} | {"\\x0200000000000000020000000200000002000000"} | {"\\x020000000000000028000000000000002c000000000000000a0000000000000000e654134c540200823000008231"} | {"\\x020000000000000028000000000000002c000000000000000c00000000000000806a73134c540200823600008233"}
(3 rows)

select min(c1), max(c1) from :tname;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c1), max(c1) from :tname where c0 = 0;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c1), max(c1) from :tname where c0 = 1;
 min | max 
-----+-----
 1   | 5
(1 row)

select min(c1), max(c1) from :tname where c0 = 2;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname where c0 = 0;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname where c0 = 1;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname where c0 = 2;
 min | max 
-----+-----
 1   | 3
(1 row)

-- verify numeric and interval
--start_ignore
drop table if exists :tname;
create table :tname (c0 int, c1 numeric, c2 interval, c3 int8, ts timestamp) using mars
 with (group_col_ = '{c0}', group_param_col_ = '{ts in 1 hour}') distributed by (c0);
--end_ignore
insert into :tname
     select i/5,
            (i+3)%7,
            make_interval(mins => ((i+5)%7)),
            i,
            '2020-10-10 09:01:02'::timestamp + i * interval '1 second'
       from generate_series(0, 12) i;
select ctid, c0, c1, c2, c3 from :tname;
 ctid  | c0 | c1 |    c2    | c3 
-------+----+----+----------+----
 (1,1) |  0 |  3 | @ 5 mins |  0
 (1,2) |  0 |  4 | @ 6 mins |  1
 (1,3) |  0 |  5 | @ 0      |  2
 (1,4) |  0 |  6 | @ 1 min  |  3
 (1,5) |  0 |  0 | @ 2 mins |  4
 (2,1) |  1 |  1 | @ 3 mins |  5
 (2,2) |  1 |  2 | @ 4 mins |  6
 (2,3) |  1 |  3 | @ 5 mins |  7
 (2,4) |  1 |  4 | @ 6 mins |  8
 (2,5) |  1 |  5 | @ 0      |  9
 (3,1) |  2 |  6 | @ 1 min  | 10
 (3,2) |  2 |  0 | @ 2 mins | 11
 (3,3) |  2 |  1 | @ 3 mins | 12
(13 rows)

\out /dev/null
select segrelid as aux_table_oid
     , segrelid::regclass::name as aux_table_name
  from mx_mars
 where relid = :tnamestr::regclass;
\out
\gset
\set aux_table_name_str '''' :aux_table_name ''''
select sum, min_at, max_at, min, max from gp_dist_random(:aux_table_name_str);
                                                                                   sum                                                                                   |                     min_at                      |                     max_at                      |                                                                       min                                                                       |                                                                       max                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------
 {"\\x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000"} | {"\\x0000000004000000020000000000000000000000"} | {"\\x0400000003000000010000000400000004000000"} | {"\\x000000000000000028000000000000002c000000000000000000000000000000804fbc124c5402008300800000000000000000000000000000000000"}                 | {"\\x00000000000000002800000000000000340000000000000004000000000000008058f9124c540200850080060000000000000000002a7515000000000000000000000000"}
 {"\\x0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002300000000000000000000000000000000000000000000000000000000000000"} | {"\\x0000000000000000040000000000000000000000"} | {"\\x0400000004000000030000000400000004000000"} | {"\\x0100000000000000280000000000000034000000000000000500000000000000c09a08134c54020085008001000000000000000000000000000000000000000000000000"} | {"\\x0100000000000000280000000000000034000000000000000900000000000000c0a345134c540200850080050000000000000000002a7515000000000000000000000000"}
 {"\\x0600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002100000000000000000000000000000000000000000000000000000000000000"} | {"\\x0000000001000000000000000000000000000000"} | {"\\x0200000000000000020000000200000002000000"} | {"\\x020000000000000028000000000000002c000000000000000a0000000000000000e654134c5402008300800000879303000000000000000000000000"}                 | {"\\x0200000000000000280000000000000034000000000000000c00000000000000806a73134c5402008500800600000000000000000095ba0a000000000000000000000000"}
(3 rows)

select min(c1), max(c1) from :tname;
 min | max 
-----+-----
   0 |   6
(1 row)

select min(c2), max(c2) from :tname;
 min |   max    
-----+----------
 @ 0 | @ 6 mins
(1 row)

select min(c1), max(c1) from :tname where c0 = 0;
 min | max 
-----+-----
   0 |   6
(1 row)

select min(c1), max(c1) from :tname where c0 = 1;
 min | max 
-----+-----
   1 |   5
(1 row)

select min(c1), max(c1) from :tname where c0 = 2;
 min | max 
-----+-----
   0 |   6
(1 row)

select min(c2), max(c2) from :tname where c0 = 0;
 min |   max    
-----+----------
 @ 0 | @ 6 mins
(1 row)

select min(c2), max(c2) from :tname where c0 = 1;
 min |   max    
-----+----------
 @ 0 | @ 6 mins
(1 row)

select min(c2), max(c2) from :tname where c0 = 2;
   min   |   max    
---------+----------
 @ 1 min | @ 3 mins
(1 row)

-- verify name and varchar
--start_ignore
drop table if exists :tname;
create table :tname (c0 int, c1 name, c2 varchar, c3 int8, ts timestamp) using mars
 with (group_col_ = '{c0}', group_param_col_ = '{ts in 1 hour}') distributed by (c0);
--end_ignore
insert into :tname
     select i/5,
            ((i+3)%7)::name,
            ((i+5)%7)::varchar,
            i,
            '2020-10-10 09:01:02'::timestamp + i * interval '1 second'
       from generate_series(0, 12) i;
select ctid, c0, c1, c2, c3 from :tname;
 ctid  | c0 | c1 | c2 | c3 
-------+----+----+----+----
 (1,1) |  0 | 3  | 5  |  0
 (1,2) |  0 | 4  | 6  |  1
 (1,3) |  0 | 5  | 0  |  2
 (1,4) |  0 | 6  | 1  |  3
 (1,5) |  0 | 0  | 2  |  4
 (2,1) |  1 | 1  | 3  |  5
 (2,2) |  1 | 2  | 4  |  6
 (2,3) |  1 | 3  | 5  |  7
 (2,4) |  1 | 4  | 6  |  8
 (2,5) |  1 | 5  | 0  |  9
 (3,1) |  2 | 6  | 1  | 10
 (3,2) |  2 | 0  | 2  | 11
 (3,3) |  2 | 1  | 3  | 12
(13 rows)

\out /dev/null
select segrelid as aux_table_oid
     , segrelid::regclass::name as aux_table_name
  from mx_mars
 where relid = :tnamestr::regclass;
\out
\gset
\set aux_table_name_str '''' :aux_table_name ''''
select sum, min_at, max_at, min, max from gp_dist_random(:aux_table_name_str);
                                                                                   sum                                                                                   |                     min_at                      |                     max_at                      |                                                                                                             min                                                                                                             |                                                                                                             max                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"\\x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000"} | {"\\x0000000004000000020000000000000000000000"} | {"\\x0400000003000000010000000400000004000000"} | {"\\x0000000000000000280000000000000068000000000000000000000000000000804fbc124c540200300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008230"} | {"\\x00000000000000002800000000000000680000000000000004000000000000008058f9124c540200360000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008236"}
 {"\\x0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002300000000000000000000000000000000000000000000000000000000000000"} | {"\\x0000000000000000040000000000000000000000"} | {"\\x0400000004000000030000000400000004000000"} | {"\\x0100000000000000280000000000000068000000000000000500000000000000c09a08134c540200310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008230"} | {"\\x0100000000000000280000000000000068000000000000000900000000000000c0a345134c540200350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008236"}
 {"\\x0600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002100000000000000000000000000000000000000000000000000000000000000"} | {"\\x0000000001000000000000000000000000000000"} | {"\\x0200000000000000020000000200000002000000"} | {"\\x0200000000000000280000000000000068000000000000000a0000000000000000e654134c540200300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008231"} | {"\\x0200000000000000280000000000000068000000000000000c00000000000000806a73134c540200360000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008233"}
(3 rows)

select min(c1), max(c1) from :tname;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c1), max(c1) from :tname where c0 = 0;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c1), max(c1) from :tname where c0 = 1;
 min | max 
-----+-----
 1   | 5
(1 row)

select min(c1), max(c1) from :tname where c0 = 2;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname where c0 = 0;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname where c0 = 1;
 min | max 
-----+-----
 0   | 6
(1 row)

select min(c2), max(c2) from :tname where c0 = 2;
 min | max 
-----+-----
 1   | 3
(1 row)

