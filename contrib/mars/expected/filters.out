--
-- when a scankey is unsupported by mars, mars silently ignores it, the scankey
-- is stilled checked by the scan node, so the result is still correct.
--
-- mars tries its best to optimize the scan with the supported scankeys,
-- however we cannot verify this in the tests.
--
\set tname test_mars_filters_t1
drop table if exists :tname;
create table :tname
     ( i4 int4
     , i8 int8
     , f4 float4
     , f8 float8
     , ts timestamp
     , vc varchar
     , xs numeric
     , kv jsonb)
 using mars
  with ( group_col_ = '{i4, i8}'
       , global_order_col_ = '{i4, i8}'
       , local_order_col_ = '{i8}'
       )
 distributed by (i4)
;
insert into :tname
select i / 4 as i4
     , i % 4 as i8
     , i * 0.1 as f4
     , i * 0.1 as f8
     , '2000-01-01'::timestamp + i::text::interval as ts
     , i as vc
     , i * 0.1 as xs
     , ('{ "key1": ' || i || ', "key2": ' || (i * 0.1) || ' }')::jsonb as kv
  from generate_series(0, 15) i
;
-- below tests may or may not contain filters unsupported by mars, the results
-- should always be correct.
select * from :tname where i4 = 2::int2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where i4 = 2::int4;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where i4 = 2::int8;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where i4 <> 2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
  3 |  1 | 1.3 | 1.3 | Sat Jan 01 00:00:13 2000 | 13 | 1.3 | {"key1": 13, "key2": 1.3}
  3 |  2 | 1.4 | 1.4 | Sat Jan 01 00:00:14 2000 | 14 | 1.4 | {"key1": 14, "key2": 1.4}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(12 rows)

select * from :tname where i4 > 2.0;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
  3 |  1 | 1.3 | 1.3 | Sat Jan 01 00:00:13 2000 | 13 | 1.3 | {"key1": 13, "key2": 1.3}
  3 |  2 | 1.4 | 1.4 | Sat Jan 01 00:00:14 2000 | 14 | 1.4 | {"key1": 14, "key2": 1.4}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(4 rows)

select * from :tname where i4::int4 = 2::int4;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where i4::int8 = 2::int8;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where i4::int8 = 2::int4;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where i4 = 2 or i4 = 0;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(8 rows)

select * from :tname where i4 in (2::int8, 0::int8);
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(8 rows)

select * from :tname where i4 = 2 and (i8 < 1 or i8 > 2);
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(2 rows)

select * from :tname where i4 = i8;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(4 rows)

select * from :tname where i4 + i8 < 4;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
(10 rows)

select * from :tname where i4 + 1 = 2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv            
----+----+-----+-----+--------------------------+----+-----+--------------------------
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
(4 rows)

select * from :tname where i4 = 2 and i4 = 2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where i4 = 2 and true;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where -i4 = -2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where abs(i4) = 2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where i4 = abs(2);
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where 1 = 1;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
  3 |  1 | 1.3 | 1.3 | Sat Jan 01 00:00:13 2000 | 13 | 1.3 | {"key1": 13, "key2": 1.3}
  3 |  2 | 1.4 | 1.4 | Sat Jan 01 00:00:14 2000 | 14 | 1.4 | {"key1": 14, "key2": 1.4}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(16 rows)

select * from :tname where 1 < 2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
  3 |  1 | 1.3 | 1.3 | Sat Jan 01 00:00:13 2000 | 13 | 1.3 | {"key1": 13, "key2": 1.3}
  3 |  2 | 1.4 | 1.4 | Sat Jan 01 00:00:14 2000 | 14 | 1.4 | {"key1": 14, "key2": 1.4}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(16 rows)

select * from :tname where true;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
  3 |  1 | 1.3 | 1.3 | Sat Jan 01 00:00:13 2000 | 13 | 1.3 | {"key1": 13, "key2": 1.3}
  3 |  2 | 1.4 | 1.4 | Sat Jan 01 00:00:14 2000 | 14 | 1.4 | {"key1": 14, "key2": 1.4}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(16 rows)

select * from :tname where i4 = '2';
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where i4 = ' 2 ';
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where i4 = +2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where i4 = 2 and i8 between 0 and 2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(3 rows)

-- var on right side
select * from :tname where 2 = i4;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where 2 > i4;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv            
----+----+-----+-----+--------------------------+----+-----+--------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
(8 rows)

select * from :tname where 2 >= i4;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(12 rows)

-- null testers
select * from :tname where i4 is not null;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
  3 |  1 | 1.3 | 1.3 | Sat Jan 01 00:00:13 2000 | 13 | 1.3 | {"key1": 13, "key2": 1.3}
  3 |  2 | 1.4 | 1.4 | Sat Jan 01 00:00:14 2000 | 14 | 1.4 | {"key1": 14, "key2": 1.4}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(16 rows)

select * from :tname where i4 is null;
 i4 | i8 | f4 | f8 | ts | vc | xs | kv 
----+----+----+----+----+----+----+----
(0 rows)

select * from :tname where i4 = null;
 i4 | i8 | f4 | f8 | ts | vc | xs | kv 
----+----+----+----+----+----+----+----
(0 rows)

select * from :tname where i4 <> null;
 i4 | i8 | f4 | f8 | ts | vc | xs | kv 
----+----+----+----+----+----+----+----
(0 rows)

-- not exprs
select * from :tname where not i4 <> 2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where not i4 = 2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
  3 |  1 | 1.3 | 1.3 | Sat Jan 01 00:00:13 2000 | 13 | 1.3 | {"key1": 13, "key2": 1.3}
  3 |  2 | 1.4 | 1.4 | Sat Jan 01 00:00:14 2000 | 14 | 1.4 | {"key1": 14, "key2": 1.4}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(12 rows)

select * from :tname where not not i4 = 2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
(4 rows)

select * from :tname where not i4 is not null;
 i4 | i8 | f4 | f8 | ts | vc | xs | kv 
----+----+----+----+----+----+----+----
(0 rows)

select * from :tname where not i4 is null;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
  3 |  1 | 1.3 | 1.3 | Sat Jan 01 00:00:13 2000 | 13 | 1.3 | {"key1": 13, "key2": 1.3}
  3 |  2 | 1.4 | 1.4 | Sat Jan 01 00:00:14 2000 | 14 | 1.4 | {"key1": 14, "key2": 1.4}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(16 rows)

select * from :tname where not i4 = null;
 i4 | i8 | f4 | f8 | ts | vc | xs | kv 
----+----+----+----+----+----+----+----
(0 rows)

select * from :tname where not i4 <> null;
 i4 | i8 | f4 | f8 | ts | vc | xs | kv 
----+----+----+----+----+----+----+----
(0 rows)

select * from :tname where ts = '2000-01-01'::timestamp;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv            
----+----+----+----+--------------------------+----+-----+--------------------------
  0 |  0 |  0 |  0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
(1 row)

select * from :tname where ts = '2000-01-01'::timestamp::timestamptz::timestamp;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv            
----+----+----+----+--------------------------+----+-----+--------------------------
  0 |  0 |  0 |  0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
(1 row)

select * from :tname where ts = '2000-01-01'::date;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv            
----+----+----+----+--------------------------+----+-----+--------------------------
  0 |  0 |  0 |  0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
(1 row)

select * from :tname where ts < '2000-01-01 00:00:10';
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv            
----+----+-----+-----+--------------------------+----+-----+--------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
(10 rows)

select * from :tname where ts < '2000-01-01'::timestamp + '10s'::interval;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv            
----+----+-----+-----+--------------------------+----+-----+--------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
(10 rows)

select * from :tname where ts + '10s'::interval < '2000-01-01 00:00:20';
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv            
----+----+-----+-----+--------------------------+----+-----+--------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
(10 rows)

select * from :tname where vc = 2;
ERROR:  operator does not exist: character varying = integer
LINE 1: select * from test_mars_filters_t1 where vc = 2;
                                                    ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
select * from :tname where vc = '2';
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv            
----+----+-----+-----+--------------------------+----+-----+--------------------------
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
(1 row)

select * from :tname where vc = ' 2 ';
 i4 | i8 | f4 | f8 | ts | vc | xs | kv 
----+----+----+----+----+----+----+----
(0 rows)

select * from :tname where vc between '2' and '8';
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv            
----+----+-----+-----+--------------------------+----+-----+--------------------------
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
(7 rows)

select * from :tname where vc in ('2', '3', '4', '5');
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv            
----+----+-----+-----+--------------------------+----+-----+--------------------------
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
(4 rows)

select * from :tname where vc like '%2';
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
(2 rows)

select * from :tname where vc = '2' || '';
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv            
----+----+-----+-----+--------------------------+----+-----+--------------------------
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
(1 row)

select * from :tname where vc = '' || 2;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv            
----+----+-----+-----+--------------------------+----+-----+--------------------------
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
(1 row)

select * from :tname where xs = 1;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where xs = 1::int4;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where xs = 1::float4;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where xs = 1::float8;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where xs = 1::numeric;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where xs = 1::numeric(10,2);
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where xs > 1.0;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
  3 |  1 | 1.3 | 1.3 | Sat Jan 01 00:00:13 2000 | 13 | 1.3 | {"key1": 13, "key2": 1.3}
  3 |  2 | 1.4 | 1.4 | Sat Jan 01 00:00:14 2000 | 14 | 1.4 | {"key1": 14, "key2": 1.4}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(5 rows)

select * from :tname where scale(xs) = 1;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
  3 |  1 | 1.3 | 1.3 | Sat Jan 01 00:00:13 2000 | 13 | 1.3 | {"key1": 13, "key2": 1.3}
  3 |  2 | 1.4 | 1.4 | Sat Jan 01 00:00:14 2000 | 14 | 1.4 | {"key1": 14, "key2": 1.4}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(16 rows)

select * from :tname where kv = kv;
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
  3 |  1 | 1.3 | 1.3 | Sat Jan 01 00:00:13 2000 | 13 | 1.3 | {"key1": 13, "key2": 1.3}
  3 |  2 | 1.4 | 1.4 | Sat Jan 01 00:00:14 2000 | 14 | 1.4 | {"key1": 14, "key2": 1.4}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(16 rows)

select * from :tname where kv = '{"key1":10,"key2":1.0}';
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where kv = '{  "key2"  :  1.0  ,  "key1"  :  10  }';
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where kv = '{"key1":10,"key2":1.0}'::jsonb;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where kv ? 'key1';
 i4 | i8 | f4  | f8  |            ts            | vc | xs  |            kv             
----+----+-----+-----+--------------------------+----+-----+---------------------------
  0 |  0 |   0 |   0 | Sat Jan 01 00:00:00 2000 | 0  | 0.0 | {"key1": 0, "key2": 0.0}
  0 |  1 | 0.1 | 0.1 | Sat Jan 01 00:00:01 2000 | 1  | 0.1 | {"key1": 1, "key2": 0.1}
  0 |  2 | 0.2 | 0.2 | Sat Jan 01 00:00:02 2000 | 2  | 0.2 | {"key1": 2, "key2": 0.2}
  0 |  3 | 0.3 | 0.3 | Sat Jan 01 00:00:03 2000 | 3  | 0.3 | {"key1": 3, "key2": 0.3}
  1 |  0 | 0.4 | 0.4 | Sat Jan 01 00:00:04 2000 | 4  | 0.4 | {"key1": 4, "key2": 0.4}
  1 |  1 | 0.5 | 0.5 | Sat Jan 01 00:00:05 2000 | 5  | 0.5 | {"key1": 5, "key2": 0.5}
  1 |  2 | 0.6 | 0.6 | Sat Jan 01 00:00:06 2000 | 6  | 0.6 | {"key1": 6, "key2": 0.6}
  1 |  3 | 0.7 | 0.7 | Sat Jan 01 00:00:07 2000 | 7  | 0.7 | {"key1": 7, "key2": 0.7}
  2 |  0 | 0.8 | 0.8 | Sat Jan 01 00:00:08 2000 | 8  | 0.8 | {"key1": 8, "key2": 0.8}
  2 |  1 | 0.9 | 0.9 | Sat Jan 01 00:00:09 2000 | 9  | 0.9 | {"key1": 9, "key2": 0.9}
  2 |  2 |   1 |   1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
  2 |  3 | 1.1 | 1.1 | Sat Jan 01 00:00:11 2000 | 11 | 1.1 | {"key1": 11, "key2": 1.1}
  3 |  0 | 1.2 | 1.2 | Sat Jan 01 00:00:12 2000 | 12 | 1.2 | {"key1": 12, "key2": 1.2}
  3 |  1 | 1.3 | 1.3 | Sat Jan 01 00:00:13 2000 | 13 | 1.3 | {"key1": 13, "key2": 1.3}
  3 |  2 | 1.4 | 1.4 | Sat Jan 01 00:00:14 2000 | 14 | 1.4 | {"key1": 14, "key2": 1.4}
  3 |  3 | 1.5 | 1.5 | Sat Jan 01 00:00:15 2000 | 15 | 1.5 | {"key1": 15, "key2": 1.5}
(16 rows)

select * from :tname where kv->>'key1' = '10';
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where kv->>'key1' = 10::text;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where (kv->>'key1')::int = 10;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where kv->>'key2' = '1.0';
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where kv->>'key2' = 1.0::text;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

select * from :tname where (kv->>'key2')::float = 1.0;
 i4 | i8 | f4 | f8 |            ts            | vc | xs  |            kv             
----+----+----+----+--------------------------+----+-----+---------------------------
  2 |  2 |  1 |  1 | Sat Jan 01 00:00:10 2000 | 10 | 1.0 | {"key1": 10, "key2": 1.0}
(1 row)

-- system attributes
select 1 from :tname where gp_segment_id = 0 limit 1;
 ?column? 
----------
        1
(1 row)

select 1 from :tname where ctid < '(2,0)' limit 1;
NOTICE:  SELECT uses system-defined column "test_mars_filters_t1.ctid" without the necessary companion column "test_mars_filters_t1.gp_segment_id"
HINT:  To uniquely identify a row within a distributed table, use the "gp_segment_id" column together with the "ctid" column.
 ?column? 
----------
        1
(1 row)

-- agg queries
select count(i4), sum(i4), sum(i8) from :tname where abs(i4) = 2;
 count | sum | sum 
-------+-----+-----
     4 |   8 |   6
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where i4 = abs(2);
 count | sum | sum 
-------+-----+-----
     4 |   8 |   6
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where i4 + i8 < 4;
 count | sum | sum 
-------+-----+-----
    10 |  10 |  10
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where i4 + 1 = 2;
 count | sum | sum 
-------+-----+-----
     4 |   4 |   6
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where i4 is null;
 count | sum | sum 
-------+-----+-----
     0 |     |    
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where i4 <> null;
 count | sum | sum 
-------+-----+-----
     0 |     |    
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where not i4 <> 2;
 count | sum | sum 
-------+-----+-----
     4 |   8 |   6
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where not i4 = 2;
 count | sum | sum 
-------+-----+-----
    12 |  16 |  18
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where not not i4 = 2;
 count | sum | sum 
-------+-----+-----
     4 |   8 |   6
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where scale(xs) = 1;
 count | sum | sum 
-------+-----+-----
    16 |  24 |  24
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where ts < '2000-01-01'::timestamp + '10s'::interval;
 count | sum | sum 
-------+-----+-----
    10 |   8 |  13
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where ts + '10s'::interval < '2000-01-01 00:00:20';
 count | sum | sum 
-------+-----+-----
    10 |   8 |  13
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where vc between '2' and '8';
 count | sum | sum 
-------+-----+-----
     7 |   6 |  11
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where vc like '%2';
 count | sum | sum 
-------+-----+-----
     2 |   3 |   2
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where vc = '2' || '';
 count | sum | sum 
-------+-----+-----
     1 |   0 |   2
(1 row)

select count(i4), sum(i4), sum(i8) from :tname where vc = '' || 2;
 count | sum | sum 
-------+-----+-----
     1 |   0 |   2
(1 row)

-- vi: et :
